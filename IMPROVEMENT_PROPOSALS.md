# Claude Slack/Discord Bot æ”¹å–„ææ¡ˆ

## ğŸ¯ æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Claude Slack/Discord Botãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚ˆã‚Šè‰¯ãã™ã‚‹ãŸã‚ã®åŒ…æ‹¬çš„ãªæ”¹å–„ææ¡ˆã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

> æ³¨: ã“ã®æ–‡æ›¸ã¯å°†æ¥æ§‹æƒ³ã‚’å«ã‚€ææ¡ˆãƒ¡ãƒ¢ã§ã™ã€‚ç¾è¡Œå®Ÿè£…ã¨å·®åˆ†ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## ğŸ“Š ä½œæˆå½“æ™‚ã®åˆ†æãƒ¡ãƒ¢ï¼ˆå‚è€ƒï¼‰

### å¼·ã¿
- âœ… ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œï¼ˆSlack/Discordï¼‰
- âœ… Gitãƒªãƒã‚¸ãƒˆãƒªçµ±åˆ
- âœ… TypeScriptã«ã‚ˆã‚‹å‹å®‰å…¨æ€§
- âœ… æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ 
- âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ï¼ˆå…¥åŠ›æ¤œè¨¼ã€ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«é˜²æ­¢ï¼‰

### æ”¹å–„ãŒå¿…è¦ãªé ˜åŸŸ
- âŒ ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®æ‹¡å……
- âŒ CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®æ¬ å¦‚
- âŒ ä¼šè©±å±¥æ­´ã®æ°¸ç¶šåŒ–ãªã—
- âŒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ãªã—
- âŒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ãªã—

## ğŸš€ æ”¹å–„ææ¡ˆ

### 1. ãƒ†ã‚¹ãƒˆåŸºç›¤ã®æ§‹ç¯‰

#### 1.1 å˜ä½“ãƒ†ã‚¹ãƒˆ
```typescript
// src/__tests__/claudeCLIClient.test.ts
describe('ClaudeCLIClient', () => {
  it('should handle timeouts correctly', async () => {
    // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†ã®ãƒ†ã‚¹ãƒˆ
  });
  
  it('should sanitize inputs properly', async () => {
    // å…¥åŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ
  });
});
```

**å®Ÿè£…å†…å®¹:**
- Jest + TypeScriptã®è¨­å®š
- å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å˜ä½“ãƒ†ã‚¹ãƒˆ
- ãƒ¢ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ãŸå¤–éƒ¨ä¾å­˜ã®åˆ†é›¢
- ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™: 80%ä»¥ä¸Š

#### 1.2 çµ±åˆãƒ†ã‚¹ãƒˆ
- E2Eãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®å°å…¥
- Slack/Discord APIã®ãƒ¢ãƒƒã‚¯
- å®Ÿéš›ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ

### 2. ä¼šè©±ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

#### 2.1 ä¼šè©±å±¥æ­´ã®æ°¸ç¶šåŒ–
```typescript
interface ConversationHistory {
  conversationId: string;
  channelId: string;
  userId: string;
  messages: Message[];
  createdAt: Date;
  updatedAt: Date;
}

class ConversationService {
  async saveMessage(message: Message): Promise<void>;
  async getHistory(conversationId: string): Promise<ConversationHistory>;
  async summarizeConversation(conversationId: string): Promise<string>;
}
```

**åˆ©ç‚¹:**
- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¿æŒã—ãŸé•·ã„ä¼šè©±ãŒå¯èƒ½
- ä¼šè©±ã®è¦ç´„æ©Ÿèƒ½
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®å±¥æ­´ç®¡ç†

#### 2.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ
- SQLite/PostgreSQLã®é¸æŠçš„ã‚µãƒãƒ¼ãƒˆ
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½

### 3. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### 3.1 ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```typescript
interface BotPlugin {
  name: string;
  version: string;
  commands?: CommandDefinition[];
  middleware?: Middleware[];
  initialize(context: PluginContext): Promise<void>;
  destroy(): Promise<void>;
}

// ä½¿ç”¨ä¾‹
class JiraPlugin implements BotPlugin {
  name = 'jira-integration';
  commands = [
    {
      name: 'jira',
      description: 'Jiraã‚¿ã‚¹ã‚¯ã‚’ç®¡ç†',
      handler: this.handleJiraCommand
    }
  ];
}
```

**å®Ÿè£…å†…å®¹:**
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ­ãƒ¼ãƒ€ãƒ¼
- ä¾å­˜é–¢ä¿‚ç®¡ç†
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹

### 4. é«˜åº¦ãªãƒªãƒã‚¸ãƒˆãƒªç®¡ç†

#### 4.1 ãƒ–ãƒ©ãƒ³ãƒç®¡ç†
```typescript
interface RepositoryManager {
  switchBranch(channelId: string, branch: string): Promise<void>;
  listBranches(channelId: string): Promise<string[]>;
  createBranch(channelId: string, branchName: string): Promise<void>;
  pullLatest(channelId: string): Promise<void>;
}
```

#### 4.2 è¤‡æ•°ãƒªãƒã‚¸ãƒˆãƒªã‚µãƒãƒ¼ãƒˆ
- ãƒãƒ£ãƒ³ãƒãƒ«ã”ã¨ã«è¤‡æ•°ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ç®¡ç†
- ãƒªãƒã‚¸ãƒˆãƒªé–“ã®åˆ‡ã‚Šæ›¿ãˆ
- ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹æ©Ÿèƒ½

### 5. ç›£è¦–ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹

#### 5.1 Prometheusãƒ¡ãƒˆãƒªã‚¯ã‚¹
```typescript
// ãƒ¡ãƒˆãƒªã‚¯ã‚¹ä¾‹
- claude_requests_total
- claude_response_duration_seconds
- repository_clone_duration_seconds
- active_conversations_count
```

#### 5.2 ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®æ‹¡å¼µ
```typescript
interface HealthCheck {
  status: 'healthy' | 'degraded' | 'unhealthy';
  checks: {
    database: CheckResult;
    claudeCLI: CheckResult;
    diskSpace: CheckResult;
    memory: CheckResult;
  };
  timestamp: Date;
}
```

### 6. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–

#### 6.1 ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆRBACï¼‰
```typescript
enum Role {
  ADMIN = 'admin',
  USER = 'user',
  VIEWER = 'viewer'
}

interface Permission {
  role: Role;
  canCloneRepo: boolean;
  canDeleteRepo: boolean;
  canResetAll: boolean;
  maxRepoSize: number;
}
```

#### 6.2 ç›£æŸ»ãƒ­ã‚°
- ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚’è¨˜éŒ²
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã®è¿½è·¡
- ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¯¾å¿œ

### 7. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### 7.1 ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ãƒ¬ã‚¤ãƒ¤ãƒ¼
```typescript
class CacheService {
  private redis: Redis;
  
  async cacheResponse(key: string, response: string, ttl: number): Promise<void>;
  async getCached(key: string): Promise<string | null>;
  async invalidatePattern(pattern: string): Promise<void>;
}
```

#### 7.2 ãƒªãƒã‚¸ãƒˆãƒªç®¡ç†ã®æœ€é©åŒ–
- æµ…ã„ã‚¯ãƒ­ãƒ¼ãƒ³ï¼ˆshallow cloneï¼‰ã®ã‚µãƒãƒ¼ãƒˆ
- å®šæœŸçš„ãªã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
- ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡ã®ç›£è¦–

### 8. é–‹ç™ºè€…ä½“é¨“ã®å‘ä¸Š

#### 8.1 CLIãƒ„ãƒ¼ãƒ«
```bash
# æ§‹æƒ³æ®µéšã®ä¾‹ï¼ˆç¾è¡Œpackage.jsonã«ã¯æœªå®Ÿè£…ï¼‰
# <å°†æ¥ã®CLI> create-plugin my-plugin
# <å°†æ¥ã®CLI> test-command /claude "Hello"
# <å°†æ¥ã®CLI> mock-server
```

#### 8.2 ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
- è©³ç´°ãªãƒ­ã‚°å‡ºåŠ›
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è¨˜éŒ²
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°

### 9. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å……å®Ÿ

#### 9.1 è‡ªå‹•ç”Ÿæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- TypeDocã«ã‚ˆã‚‹APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- OpenAPIä»•æ§˜æ›¸
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ï¼ˆMermaidï¼‰

#### 9.2 ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
- ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
- ãƒ“ãƒ‡ã‚ªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
- ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰

### 10. é…å¸ƒã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

#### 10.1 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°
- NPMãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å…¬é–‹
- Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®è‡ªå‹•ãƒ“ãƒ«ãƒ‰
- Helm chartã®æä¾›

#### 10.2 ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒãƒ¼ãƒˆ
- AWS Lambdaå¯¾å¿œ
- Kuberneteså¯¾å¿œ
- è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°

## ğŸ—“ï¸ å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase 1ï¼ˆ1-2ãƒ¶æœˆï¼‰
- [ ] ãƒ†ã‚¹ãƒˆåŸºç›¤ã®æ§‹ç¯‰
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®è¨­å®š
- [ ] åŸºæœ¬çš„ãªä¼šè©±å±¥æ­´æ©Ÿèƒ½

### Phase 2ï¼ˆ2-3ãƒ¶æœˆï¼‰
- [ ] ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ
- [ ] ç›£è¦–ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### Phase 3ï¼ˆ3-4ãƒ¶æœˆï¼‰
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- [ ] é«˜åº¦ãªãƒªãƒã‚¸ãƒˆãƒªç®¡ç†

### Phase 4ï¼ˆ4-5ãƒ¶æœˆï¼‰
- [ ] ã‚¯ãƒ©ã‚¦ãƒ‰å¯¾å¿œ
- [ ] ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºæ©Ÿèƒ½
- [ ] ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ§‹ç¯‰

## ğŸ’¡ ã‚¯ã‚¤ãƒƒã‚¯ã‚¦ã‚£ãƒ³

ã™ãã«å®Ÿè£…ã§ãã‚‹æ”¹å–„ï¼š

1. **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ”¹å–„**
   - ã‚ˆã‚Šåˆ†ã‹ã‚Šã‚„ã™ã„æ—¥æœ¬èªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   - è§£æ±ºæ–¹æ³•ã®ææ¡ˆ

2. **ã‚³ãƒãƒ³ãƒ‰ã‚¨ã‚¤ãƒªã‚¢ã‚¹**
   ```typescript
   /claude â†’ /c
   /claude-repo â†’ /cr
   ```

3. **è‡ªå‹•è£œå®Œã‚µãƒãƒ¼ãƒˆ**
   - ã‚³ãƒãƒ³ãƒ‰ã®è‡ªå‹•è£œå®Œ
   - ãƒªãƒã‚¸ãƒˆãƒªURLã®å±¥æ­´

4. **é€²æ—è¡¨ç¤ºã®æ”¹å–„**
   - ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼
   - æ¨å®šå®Œäº†æ™‚é–“

5. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒãƒ¼ãƒˆ**
   ```yaml
   # agent-chatbot.yml
   defaults:
     timeout: 0
     maxOutputSize: 10MB
   repositories:
     allowlist:
       - github.com/myorg/*
   ```

## ğŸ¯ æˆåŠŸæŒ‡æ¨™

- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸: 80%ä»¥ä¸Š
- å¹³å‡å¿œç­”æ™‚é–“: 3ç§’ä»¥å†…
- ã‚¢ãƒƒãƒ—ã‚¿ã‚¤ãƒ : 99.9%
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦: 4.5/5ä»¥ä¸Š
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ•°: 20ä»¥ä¸Š

## ğŸ¤ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£

- Discord/Slackã‚µãƒãƒ¼ãƒˆãƒãƒ£ãƒ³ãƒãƒ«
- æœˆæ¬¡ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒŸãƒ¼ãƒˆã‚¢ãƒƒãƒ—
- ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
- ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ç¶™ç¶šçš„ã«æ›´æ–°ã•ã‚Œã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åæ˜ ã—ã¾ã™ã€‚*
